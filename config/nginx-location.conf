# RowLab nginx configuration
# Add this location block to your existing nginx server configuration
# Example: /etc/nginx/sites-available/your-domain

# Option 1: Serve on subdomain (recommended)
# server {
#     listen 443 ssl http2;
#     server_name rowlab.yourdomain.com;
#
#     # SSL configuration (same as your main site)
#     ssl_certificate /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
#     ssl_certificate_key /etc/letsencrypt/live/yourdomain.com/privkey.pem;
#
#     location / {
#         proxy_pass http://localhost:3002;
#         proxy_http_version 1.1;
#         proxy_set_header Upgrade $http_upgrade;
#         proxy_set_header Connection 'upgrade';
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto $scheme;
#         proxy_cache_bypass $http_upgrade;
#     }
# }

# Option 2: Serve on subpath (add to existing server block)
location /rowlab {
    proxy_pass http://localhost:3002;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_cache_bypass $http_upgrade;

    # Optional: Add authentication
    # auth_basic "RowLab Access";
    # auth_basic_user_file /etc/nginx/.htpasswd;
}

# Cache static assets
location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}
